\ProvidesPackage{config/arms}
%%%%% Weapons
%
% Weapon entries do two things.
% When used in creatures, they raise stats.
% When used in the weapons chart, they display stats.
%
% Use this 'weapon entry' command to place items in the weapons table, like this:
%\weapon[optional arguments]{Name}%
%{Bonus}
%{Dam}
%
% The AP cost ('heft') = ( Att + Dam ) / 2
% The Weight Rating = ( Att + Dam ) - 3

\newcounter{weaponBonus}
\newcounter{weaponDamage}
\newcounter{weaponWeight}
\newcounter{covering}
\newcounter{armourDR}
\newcounter{armourWeight}

\newcommand\weaponName{}
\newcommand\armourName{}

\newcommand\weapon[4][0]{%
  \renewcommand\weaponName{#2}%
  \setcounter{weaponBonus}{#3}%
  \setcounter{weaponDamage}{#4}%
  \setcounter{weaponWeight}{#3}%
  \ifnum#3<0%
    \multiply\value{weaponWeight} by -1%
  \fi%
  \ifnum#4>0%
    \addtocounter{weaponWeight}{#4}%
  \fi%
  \roundUp{weaponWeight}%
  \addtocounter{weaponWeight}{#1}%
  \setcounter{heft}{\value{weaponWeight}}%
  \ifnum\value{heft}<1\setcounter{heft}1\fi%
}

\newcommand\hitLocation{
  \begin{boxtable}[XXXX]
    \textbf{Damage} & \textbf{Location} & \textbf{Slash} & \textbf{Bash} \\
    \hline
    \dicef{1} & ear & cut & bruised \\
    \dicef{2} & cheek & slashed & bashed \\
    \dicef{3} & belly & spliced & smashed \\
    \dicef{4} & ribs & pierced & shattered \\
    \dicef{5} & arm & mutilated & crippled \\
    \dicef{6} & thigh & gashed open & cracked \\
    \dicef{7} & jaw & thwacked & chiseled \\
    \dicef{8} & shin & segmented & splintered \\
    \dicef{9} & skull & bisected & demolished \\
    \dicef{10} & heart & opened & interrupted \\
  \end{boxtable}
}

%% Use this to show weapons in tables.
%% Remember to close it with '\\' after.
%% It remains unterminated so you can add Costs.

\newcommand\showWeapon[1]{%
  #1 \weaponName & \absNum{weaponBonus} & \absNum{weaponDamage} & \ifnum\value{weaponWeight}<1$\frac{1}{3}$\else\arabic{weaponWeight}\fi
}

\newcounter{secondWeaponWeight}

\newcommand\rangedWeapon[5][1]{%
  #2 %
  \addtocounter{equipmentWeight}{#1}%
  \setTN[#3]{Dexterity}{Projectiles}%
  (\glsentrytext{tn}~\arabic{tn}, \dmg{#4}, %
  \ifnum#5>10% Indicate a crossbow with a VERY high reload time.
    \setcounter{encnum}{#5}% Reload time is set to, e.g. '15' (meaning '5').
    \addtocounter{encnum}{-10}% Let's make 15 --> 5
    \addtocounter{encnum}{#1}% Weight adds to AP.
    reload: \arabic{encnum}~\glsfmtplural{round}%
  \else%
    \glsfmtplural{ap}~Cost:~{#5}%
  \fi)%
}

\newcommand{\rock}{%
  \set{track}{Strength}%
  \rangedWeapon{rock}%
  {0}% Att
  {\arabic{track}}% Dam
  {2}% AP Cost
}

\newcommand\smolCrossBow{%
  \rangedWeapon[2]{crossbow}%
  {2}% Att
  {0}% Dam
  {15}% AP Cost
}

% RANGED WEAPONS
\newcommand{\longbow}{%
  \set{encnum}{Strength}%
  \addtocounter{encnum}{2}%
  \rangedWeapon[1]{longbow}%
  {\arabic{Strength}}% Att
  {Strength}% Dam
  {\arabic{encnum}}% AP Cost
}

\newcommand{\projectilesChart}{
\begin{boxtable}[lYYXYYY]

  \textbf{Projectile} &   \textbf{\Glsfmttext{ap} Cost} & \textbf{Bonus} & \textbf{Damage} & \textbf{\Glsfmttext{weight}}  & \textbf{Reload Time} & \textbf{Min. Strength} \\\hline

  Light Crossbow      &               1                &    +2           & \dmg{0}         & 2                             & 5~Rnds -- Str.        &    -2    \\

  Standard Crossbow   &               1                &    +0           & \dmg{4}         & 4                             & 5~Rnds -- Str.      &    -1    \\

  Heavy Crossbow      &               2                &    -1           & \dmg{6}         & 5                             & 5~Rnds -- Str.      &    0     \\
  \hline

  Shortbow            &               1                &    +0           & \dmg{-1}        & 1                             & 1~\gls{ap}             &    -1    \\

  Light Bow           &               2                &    +0           & \dmg{0}         & 1                             & 2~\glspl{ap}           &    +1    \\

  Hunting Bow         &               3                &    +1           & \dmg{1}         & 1                             & 3~\glspl{ap}           &    +1    \\

  Longbow             &               5                &    +3           & \dmg{3}         & 1                             & 5~\glspl{ap}           &    +3    \\

  Great Bow           &               7                &    +4           & \dmg{4}         & 2                             & 6~\glspl{ap}           &    +4    \\
  \hline

  Throwing knives     &               1                &    +0           & \dmg{-1}         & 1/10                          & 1 \gls{ap}           &    -2    \\

\end{boxtable}
}

\newcommand\armour[4][]{
  \renewcommand\armourName{#2}% Name
  \setcounter{armourDR}{#3}%
  \setcounter{covering}{#4}%
  \setcounter{armourWeight}{#4}%
  \addtocounter{armourWeight}{#3}%
  \addtocounter{armourWeight}{1}%
  \divide\value{armourWeight} by 3%
  \addtocounter{armourWeight}{0}%
  #1% <- for adjustments.
}

\newcommand\showArmour[1]{%
  #1 \expandafter\MakeUppercase\armourName & \arabic{armourDR} & \arabic{covering} & \arabic{armourWeight}
}

\newcommand{\boulder}{\weapon{Boulder}{-3}{5}}
\newcommand{\chair}{\weapon[1]{Chair}{2}{1}}
\newcommand{\club}{\weapon{Club}{1}{1}}
\newcommand{\cudgel}{\weapon{Cudgel}{0}{0}}
\newcommand{\Dagger}{\weapon[-1]{Dagger}{0}{2}}
\newcommand{\firepoker}{\weapon{Firepoker}{1}{0}}
\newcommand{\flail}{\weapon{Flail}{0}{3}}
\newcommand{\giantsword}{\weapon{Giant Sword}{4}{3}}
\newcommand{\greataxe}{\weapon{Great Axe}{2}{3}}
\newcommand{\greatsword}{\weapon{Greatsword}{3}{3}}
\newcommand{\greatclub}{\weapon{Great Club}{3}{4}}
\newcommand{\javelin}{\weapon{Javelin}{2}{1}}
\newcommand{\knife}{\weapon[-1]{Knife}{0}{1}}
\newcommand{\Log}{\weapon[1]{Log}{1}{0}}
\newcommand{\rapier}{\weapon{Rapier}{1}{1}}
\newcommand{\largerock}{\weapon{Rock (large)}{-1}{2}}
\newcommand{\longsword}{\weapon{Longsword}{2}{2}}
\newcommand{\maul}{\weapon{Maul}{1}{3}}
\newcommand{\poleaxe}{\weapon{Poleaxe}{2}{3}}
\newcommand{\quarterstaff}{\weapon{Quarterstaff}{3}{0}}
\newcommand{\scythe}{\weapon[1]{Scythe}{-1}{2}}
\newcommand{\shortsword}{\weapon{Shortsword}{1}{1}}
\newcommand{\skillet}{\weapon[1]{Frying Pan}{1}{2}}
\newcommand{\spear}{\weapon{Spear}{3}{1}}
\newcommand{\glaive}{\weapon{Glaive}{3}{2}}
\newcommand{\stick}{\weapon{Stick}{1}{0}}
\newcommand{\walkingStick}{\weapon{Walking stick}{1}{0}}
\newcommand{\whip}{\weapon{Whip}{1}{0}}
\newcommand{\warhammer}{\weapon{Warhammer}{1}{4}}
\newcommand{\woodaxe}{\weapon{Wood Axe}{1}{2}}

\newcommand{\crapLongsword}{\weapon[1]{Inferior longsword}{2}{2}}
\newcommand{\crapRapier}{\weapon[1]{Shoddy rapier}{1}{1}}
\newcommand{\crapGlaive}{\weapon[1]{Unbalanced glaive}{3}{2}}
\newcommand{\crapBuckler}{\weapon[1]{Shoddy buckler}{2}{-4}}

\newcommand\improvisedWeaponsChart{

  \begin{boxtable}[XYYY]

  \textbf{Improvised Weapon} & \textbf{Attack Bonus} & \textbf{Damage Bonus} & \textbf{\Gls{weight}} \\\hline

  \showWeapon{\boulder} \\

  \showWeapon{\chair} \\

  \showWeapon{\club} \\

  \showWeapon{\cudgel} \\

  \showWeapon{\firepoker} \\

  \showWeapon{\skillet} \\

  \showWeapon{\knife} \\

  \showWeapon{\Log} \\

  \showWeapon{\scythe} \\

  \showWeapon{\stick} \\

  \showWeapon{\woodaxe} \\

  \end{boxtable}

}

\newcommand{\weaponsChart}{
  \begin{boxtable}[lYYY]

  \textbf{Weapon} & \textbf{\small Attack Bonus} & \textbf{\small Damage Bonus} & \textbf{\small \Gls{weight}} \\\hline

  \showWeapon{\Dagger} \\

  \showWeapon{\glaive} \\

  \showWeapon{\greataxe} \\

  \showWeapon{\greatsword} \\

  \showWeapon{\javelin} \\

  \showWeapon{\longsword} \\

  \showWeapon{\maul} \\

  \showWeapon{\poleaxe} \\

  \showWeapon{\quarterstaff} \\

  \showWeapon{\shortsword} \\

  \showWeapon{\spear} \\

  \end{boxtable}
}

\newcommand\esotericWeaponsChart{
  \begin{boxtable}[lYYY]

  \textbf{Esoteric Weapons} & \textbf{Attack Bonus} & \textbf{Damage Bonus} & \textbf{\Gls{weight}} \\\hline

  \showWeapon{\greatclub} \\

  \showWeapon{\giantsword} \\

  \showWeapon{\rapier} \\

  \showWeapon{\warhammer} \\

  \showWeapon{\whip} \\

  \end{boxtable}
}

% SHIELDS
\newcommand{\buckler}{\weapon{Buckler}{2}{-4}}
\newcommand{\roundshield}{\weapon{Round Shield}{3}{-2}}
\newcommand{\kiteshield}{\weapon{Kite Shield}{4}{-4}}

\newcommand{\shieldchart}{
  \begin{boxtable}[XYYY]

  \textbf{Shield} & \textbf{Defence Bonus} & \textbf{Damage Bonus} & \textbf{\Gls{weight}} \\\hline

  \showWeapon{\buckler} \\
  \showWeapon{\roundshield} \\
  \showWeapon{\kiteshield} \\

  \end{boxtable}
}


% ARMOUR

%%%%%%%%% Old Armour, Delete Later

%% For perfect armour, stick \perfect Armour in the additional notes category of a \person (#9).

\newcommand{\perfectArmour}{\setcounter{covering}{8}}

\newcommand{\partialelvish}{%
  \armour[\addtocounter{armourWeight}{-1}]{Elvish Ceramic armour}{2}{3}%
}

\newcommand{\partialpadded}{%
  \armour[\addtocounter{armourWeight}{1}]{padded armour}{3}{3}%
}

\newcommand{\partialleather}{%
  \armour{partial leather}{3}{3}%
}

\newcommand{\completeleather}{%
  \armour{complete leather}{3}{5}%
}

\newcommand{\partialchain}{%
  \armour{partial chainmail}{4}{3}%
}

\newcommand{\completechain}{%
  \armour{complete chainmail}{4}{5}%
}

\newcommand{\partiallisk}{%
  \armour{partial lisk-hide}{4}{3}%
}

\newcommand{\completelisk}{%
  \armour{complete lisk-hide}{4}{5}%
}

\newcommand{\partialplate}{%
  \armour{partial plate}{5}{3}%
}

\newcommand{\completeplate}{%
  \armour{complete plate}{5}{5}%
}
\newcommand{\armourchart}{

  \begin{boxtable}[Xccc]

  \textbf{Armour} & \textbf{\Glsentrytext{dr}} & \textbf{\glsentrytext{covering}} & \textbf{Weight} \\\hline

  \ifodd\value{r4}
    \showArmour{\partialelvish} \\
  \fi

  \showArmour{\partialpadded} \\
                                                                             
  \showArmour{\partialleather} \\
                                                                             
  \showArmour{\completeleather} \\
                                                                             
  \showArmour{\partialchain} \\
                                                                             
  \showArmour{\completechain} \\
                                                                             
  \showArmour{\partialplate} \\
                                                                             
  \showArmour{\completeplate} \\

  \end{boxtable}
}
